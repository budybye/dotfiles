#! /usr/bin/env bash

echo "--------------------------------"
echo "Welcome to my dotfiles!!"
echo "whoami: $(whoami)"
echo "OS info ..."
uname -a
echo "$SHELL"
echo "--------------------------------"
echo "env ..."
env
echo "--------------------------------"
echo "$PATH ..."
echo "$PATH" | tr ':' '\n'
echo "--------------------------------"
echo "SSH key ..."
cat /etc/ssh/sshd_config
ls -la ~/.ssh
cat ~/.ssh/id_ed25519.pub
echo "--------------------------------"
echo "git config ..."
git config --list
echo "--------------------------------"
echo "Package update && check start!!"
echo "--------------------------------"
{{- if eq .chezmoi.os "linux" }}
    echo "Linux"
    apt --version
    sudo apt-get update -y
    sudo apt-get upgrade -y
    sudo apt-get install -y {{ .packages.linux.cli | join " " }}
    sudo apt-get autoremove -y
    sudo apt-get autoclean -y
    sudo apt-get check
{{- else if eq .chezmoi.os "darwin" }}
    echo "Darwin"
    if ! command -v brew >/dev/null 2>&1; then
        echo "brew command not found"
    else
        brew --version
        brew install {{ .packages.darwin.brews | join " " }}
        brew update
        brew upgrade
        brew autoremove
        brew cleanup
        brew doctor
    fi
{{- end }}

echo "--------------------------------"
echo "Package update && check done!!"
