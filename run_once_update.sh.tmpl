#! /usr/bin/env bash

echo "--------------------------------"
echo "Welcome to my dotfiles!!"
echo "whoami: $(whoami)"
echo "OS info ..."
uname -a
echo "$SHELL"
echo "--------------------------------"
echo "env ..."
env
echo "--------------------------------"
echo "$PATH ..."
echo "$PATH" | tr ':' '\n'
echo "--------------------------------"
echo "SSH key ..."
chmod 700 ~/.ssh
chmod 600 ~/.ssh/authorized_keys
chmod 600 ~/.ssh/id_ed25519
chmod 644 ~/.ssh/id_ed25519.pub
cat /etc/ssh/sshd_config
ls -la ~/.ssh
echo "--------------------------------"
echo "git config user.name"
git config user.name
git config user.email
echo "--------------------------------"
echo "Package update && check start!!"
echo "--------------------------------"
{{ if eq .chezmoi.os "linux" }}
    echo "Linux"
    apt --version
    sudo apt-get update -y
    sudo apt-get upgrade -y
    sudo apt-get install -y {{ .packages.linux | join " " }}
    sudo apt-get autoremove -y
    sudo apt-get autoclean -y
    sudo apt-get check
{{ else if eq .chezmoi.os "darwin" }}
    echo "Darwin"
    if ! command -v brew >/dev/null 2>&1; then
        echo "brew command not found"
    else
        brew install {{ .packages.darwin | join " " }}
        brew update
        brew upgrade
        brew autoremove
        brew cleanup
        brew doctor
    fi
{{ end }}

echo "--------------------------------"
echo "Package update && check done!!"
