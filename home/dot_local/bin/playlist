#!/usr/bin/env bash

set -eu

PLAYLIST_ID="PLMXoRsxtzGfCH7cvhAnzN_T3KvKmdkB3s"
PLAYLIST_FILE="${XDG_MUSIC_DIR:-${HOME}/Music}/playlist.json"

if ! command -v yt-dlp > /dev/null 2>&1; then
  echo "yt-dlp not found"
fi

if ! command -v jq > /dev/null 2>&1; then
  echo "jq not found"
fi

echo "scanning ${PLAYLIST_ID}..."

yt-dlp -j --flat-playlist "https://youtube.com/playlist?list=${PLAYLIST_ID}" | \
  jq -s '[.[] | {title: .title, videoId: .id}]' > ${PLAYLIST_FILE}

echo "${PLAYLIST_FILE} created"

# cat ${PLAYLIST_FILE}
