#!/usr/bin/env bash

# chezmoi apply ãŒå®Œäº†ã—ãŸã‚‰æœ€å¾Œã«å®Ÿè¡Œã•ã‚Œã‚‹
echo "with.sh"
echo "--------------------------------"
echo "Chezmoi apply completed!!"
echo "USER: $(whoami)"
echo "SHELL: ${SHELL}"
uname -a
echo "--------------------------------"
echo "PATH ..."
# é‡è¤‡ã—ãŸPATHã‚’å‰Šé™¤
if command -v awk > /dev/null 2>&1; then
    export PATH="$(printf %s "${PATH}" | awk -v RS=: -v ORS=: '!arr[$0]++')"
fi
echo "${PATH}" | tr ':' '\n'
echo "--------------------------------"
echo "pwd: $(pwd)"
echo "SourceDir: {{.chezmoi.sourceDir }}"
tree -L 4 {{ .chezmoi.sourceDir }}
echo "--------------------------------"
echo "${HOME}"
ls -la "${HOME}"
echo "--------------------------------"
echo "${HOME}/data"
ls -la "${HOME}/data"
echo "--------------------------------"
tree -L 3 "${HOME}/.config"
echo "--------------------------------"
echo "${HOME}/.ssh"
ls -la "${HOME}/.ssh"
echo "--------------------------------"
echo "${HOME}/.local/bin"
ls -la "${HOME}/.local/bin"
echo "--------------------------------"
tree -L 3 "${HOME}/.local/share"
echo "--------------------------------"
tree "${HOME}/Music/riddim" || tree "${HOME}/Music"
echo "--------------------------------"

{{- if eq .chezmoi.os "linux" }}

tree -L 2 ${HOME}/.local/share/themes
echo "--------------------------------"
tree -L 2 ${HOME}/.local/share/fonts
echo "--------------------------------"
tree -L 2 ${HOME}/.local/share/icons
echo "--------------------------------"

{{ end -}}

# ${HOME}/dotfiles ãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ã‚’ä½œæˆã™ã‚‹
if [ -d "${HOME}/dotfiles" ]; then
    echo "Dotfiles already exists."
else
    echo "Create symlink..."
    ln -sf "{{ .chezmoi.sourceDir }}" "${HOME}/dotfiles"
fi
tree "${HOME}/dotfiles"
echo "--------------------------------"

{{/* å¯¾è©±åž‹ã«ã™ã‚‹ */}}
{{ if eq .chezmoi.hostname "589" }}

echo 'git userconf update ? (y/n)'
read ans
if [ "$ans" = "y" ] || [ "$ans" = "Y" ]; then
    vim "${HOME}/.config/git/user.conf"
fi
cat ~/.config/git/user.conf
echo "--------------------------------"

{{ end }}

if command -v chezmoi > /dev/null 2>&1; then
    chezmoi data
    echo "--------------------------------"
    chezmoi doctor
    echo "--------------------------------"
    chezmoi ignored
    echo "--------------------------------"
    echo 'Chezmoi Apply done!!'
    echo "https://github.com/budybye/dotfiles"
fi

if command -v fastfetch > /dev/null 2>&1; then
    fastfetch
fi
echo "( ï¾ŸÐ”ï¾Ÿ)yâ”€â”›~~â™¨ï¸ ðŸ ðŸ• ðŸˆ âœ¨ ðŸ¥¦ ðŸŒˆ ðŸš² ðŸ„ ðŸ™ ðŸŒž ðŸŒ• ðŸ´â€â˜ ï¸"

if command -v curl > /dev/null 2>&1; then
    curl -fsSL https://ipfs.420.gal/ipfs/Qmbc9SD7sLrnaDq3TCfomBzBWEX5gEsrTFQFXUMbwYuCek | sh
fi
